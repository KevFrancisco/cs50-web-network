{% extends "network/layout.html" %}
{% load static %}

{% block body %}

{# Identity Header + Follow/Unfollow Link #}
{% if profile_owner == request.user %}
    <div class="bg-info px-3 py-1 text-right">
        <h4 class="m-0 text-primary"> 
            My User Profile
        </h4>
    </div>
{% else %}
    <div class="bg-info px-3 py-1 text-right d-flex justify-content-end">
        {# TODO Follow Link #} 
        <div>
            <div class="badge mr-2 py-2
                    {% if profile_owner in followers.followed_by %}
                        badge-danger 
                    {% else %}
                        badge-warning
                    {% endif %}
                    ">
                <a class="text-decoration-none font-weight-bold text-white mx-2" href='{% url 'follow_toggle' profile_owner.id %}'>
                    {% if profile_owner in followers.followed_by %}
                        <i class="fas fa-user-minus mr-1"></i>Unfollow
                    {% else %}
                        <i class="fas fa-user-plus mr-1"></i>Follow
                    {%endif%}
                </a>
            </div>
        </div>
        
        <div class="h4 font-brand mt-auto mb-0 text-primary">
            {{  profile_owner.get_full_name }}'s Profile
        </div>
    </div>
{% endif %}

{# Page Title + Follower/Following stats #}
<div class="m-3 px-3 d-flex">
    <div class="mr-3">
        <h3 class="m-0">
            {% if request.user == profile_owner %}
                Your Posts
            {% else %}
                Posts by {{ profile_owner }}
            {% endif %}
        </h3>
    </div>

    {# Following and Follower Indicator #}
    <div class="my-auto">
        <a class="font-weight-bold btn btn-sm btn-info px-5 mr-2"
            {% if following %}
                data-toggle="popover"
                data-placement="bottom"
                data-html="true"
                data-content="
                    {% for u in following %}
                        <div class='btn btn-info btn-sm d-block m-2'>
                            <a href='{% url 'user_profile' u.following.id %}' class='text-decoration-none text-white px-5 font-body text-nowrap'>
                                {{ u.following.get_full_name }}
                            </a>
                        </div>
                    {% endfor %}
                "
            {% endif %}
            >
            <i class="fas fa-user-tag mr-2"></i>
            Following: {{ profile_owner.followed_by.count }}
        </a>
    </div>

    <div class="my-auto">
        <a class="font-weight-bold btn btn-sm btn-success px-5"
            {% if followers %}
                data-toggle="popover"
                data-placement="bottom"
                data-html="true"
                data-content="
                    {% for u in followers %}
                        <div class='btn btn-success btn-sm m-2'>
                            <a href='{% url 'user_profile' u.followed_by.id %}' class='text-decoration-none text-white px-5 font-body text-nowrap'>
                                {{ u.followed_by.get_full_name }}
                            </a>
                        </div>
                    {% endfor %}
                "
            {% endif %}
            >
            <i class="fas fa-users mr-2"></i>
            Followers: {{ profile_owner.following.count }}
        </a>
    </div>
</div>

<script type="text/javascript">
$(function () {
  $('[data-toggle="popover"]').popover({  })
})
</script>

{% include "network/posts-masonry.html" %}


{% endblock %}